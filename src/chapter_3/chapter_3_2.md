# 3.2 åŸºæœ¬æ•°æ®ç±»å‹

Rustæ˜¯é™æ€ç±»å‹è¯­è¨€ï¼Œç¼–è¯‘æ—¶å°±å¿…é¡»çŸ¥é“æ‰€æœ‰å˜é‡çš„ç±»å‹ã€‚æ ¹æ®å€¼ä»¥åŠå…¶ä½¿ç”¨æ–¹å¼ï¼ŒRustç¼–è¯‘å™¨é€šå¸¸èƒ½è‡ªåŠ¨æ¨å¯¼å‡ºå˜é‡çš„ç±»å‹ã€‚
Rustæœ‰ä¸¤ç§æ•°æ®ç±»å‹å­é›†ï¼Œåˆ†åˆ«æ˜¯ï¼šæ ‡é‡ï¼ˆscalarï¼‰ç±»å‹å’Œå¤åˆï¼ˆcompoundï¼‰ç±»å‹ã€‚

## 3.2.1 æ ‡é‡ç±»å‹

æ ‡é‡ç±»å‹åŒ…æ‹¬ï¼šæ•´å‹ã€æµ®ç‚¹å‹ã€å¸ƒå°”ç±»å‹å’Œå­—ç¬¦ç±»å‹ã€‚

### 3.2.1.1 æ•´å‹å’Œæµ®ç‚¹å‹

Rustä¸­çš„æ•´å‹å’Œæµ®ç‚¹å‹å¦‚ä¸‹ï¼š

| é•¿åº¦ | æœ‰ç¬¦å· | æ— ç¬¦å· | æµ®ç‚¹å‹|
| ---- | ----- | ------ | ----- |
|8 bit |  i8   |   u8   |       |
|16 bit|  i16  |   u16  |       |
|32 bit|  i32  |   u32  |  f32  |
|64 bit|  i64  |   u64  |  f64  |
|128 bit| i128 |   u128 |       |
| arch | isize |  usize |       |

è¯´æ˜ï¼š`isize`å’Œ`usize`çš„é•¿åº¦æ˜¯å’Œå¹³å°ç›¸å…³ï¼Œå¦‚æœCPUæ˜¯32ä½çš„ï¼Œåˆ™è¿™ä¸¤ä¸ªç±»å‹æ˜¯32ä½çš„ï¼Œå¦‚æœCPUæ˜¯64ä½çš„ï¼Œåˆ™è¿™ä¸¤ä¸ªç±»å‹æ˜¯64ä½çš„ã€‚

ä¸Šé¢çš„è¡¨æ ¼ä¸­ï¼Œ`f32`å’Œ`f64`ä¸ºæµ®ç‚¹å‹ï¼Œå…¶å®ƒä¸ºæ•´å‹ã€‚æµ®ç‚¹å‹å’Œæ•´å‹ä¸€èµ·æ„æˆæ•°å€¼å‹ã€‚

ï¼ˆ1ï¼‰å¯ä»¥åœ¨æ•°å€¼å­—é¢é‡åé¢åŠ ä¸Šç±»å‹è¡¨ç¤ºè¯¥ç±»å‹çš„æ•°å€¼ï¼Œå¦‚ä¸‹ï¼š

```rust
fn main(){
  let _a = 33u32;    // ç›´æ¥åŠ ç±»å‹åç¼€
  let _b = 33_i32;   // ä½¿ç”¨_åˆ†éš”æ•°å€¼å’Œç±»å‹
  let _c = 33_isize;
  let _d = 33_f32;
}
```

ï¼ˆ2ï¼‰å¯ä»¥æ•°å€¼çš„ä»»æ„ä½ç½®ä½¿ç”¨ä¸‹åˆ’çº¿åˆ†å‰²æ¥å¢å¼ºå¯è¯»æ€§ï¼Œå¦‚ä¸‹ï¼š

```rust
fn main(){
  let _a = 10_000_000u32;
  let _b = 1_234_3_u32;
  let _c = 1_33_333f32;
}
```

ï¼ˆ3ï¼‰å½“ä¸æ˜ç¡®æŒ‡å®šå˜é‡çš„ç±»å‹ï¼Œä¹Ÿä¸æ˜ç¡®æŒ‡å®šæ•°å€¼å­—é¢é‡çš„ç±»å‹åç¼€æ—¶ï¼ŒRusté»˜è®¤å°†æ•´æ•°å½“åš`i32`ç±»å‹ï¼Œå°†æµ®ç‚¹æ•°å½“åš`f64`ç±»å‹ï¼Œå¦‚ä¸‹ï¼š

```rust
fn main(){
  let _a = 33;     // ç­‰ä»·äº let _a: i32 = 33;    ç­‰ä»·äº let _a = 33i32;
  let _b = 64.123; // ç­‰ä»·äºlet _b: f64 = 64.123; ç­‰ä»·äº let _b = 64.123f64;
}
```

ï¼ˆ4ï¼‰Rustä½¿ç”¨`0b`è¡¨ç¤ºäºŒè¿›åˆ¶ã€`0o`è¡¨ç¤ºå…«è¿›åˆ¶ã€`0x`è¡¨ç¤ºåå…­è¿›åˆ¶ï¼Œå¦‚ä¸‹ï¼š

```rust
fn main(){
  let a: u32 = 0b101;      // äºŒè¿›åˆ¶æ•´æ•°
  let b: i32 = 0o17;       // å…«è¿›åˆ¶æ•´æ•°
  let c: u8 = 1;           // åè¿›åˆ¶
  let d: i32 = 0xac;       // åå…­è¿›åˆ¶æ•´æ•°
  println!("{}, {}, {}, {}", a, b, c, d);  // 5, 15, 1, 172
}
```

ï¼ˆ5ï¼‰Rustä¸­æ‰€æœ‰çš„æ•°å€¼ç±»å‹éƒ½æ”¯æŒåŸºæœ¬æ•°å­¦è¿ç®—ï¼šåŠ ã€å‡ã€ä¹˜ã€é™¤ã€å–ä½™ï¼Œå¦‚ä¸‹ï¼š

```rust
fn main() {
    let sum = 5 + 10;
    let difference = 95.5 - 4.3;
    let product = 4 * 30;
    let quotient = 56.7 / 32.2;
    let truncated = -5 / 3; // ç»“æœä¸º -1
    let remainder = 43 % 5;
}
```

### 3.2.1.2 å¸ƒå°”å‹

Rustä¸­çš„å¸ƒå°”å‹ç”¨`bool`è¡¨ç¤ºï¼Œæœ‰ä¸¤ä¸ªå¯èƒ½çš„å€¼ï¼Œä¸º`true`å’Œ`false`ã€‚å¸ƒå°”ç±»å‹ä½¿ç”¨çš„åœºæ™¯ä¸»è¦æ˜¯æ¡ä»¶è¡¨è¾¾å¼ï¼ˆæ§åˆ¶æµçš„å†…å®¹ï¼‰ï¼Œä½¿ç”¨å¦‚ä¸‹ï¼š

```rust
fn main() {
    // å®šä¹‰æ–¹å¼
    let a: bool = true;
    let b: bool = false;

    // ä½¿ç”¨åœºæ™¯
    if a {
        println!("a is true");
    } else {
        println!("a is false");
    }

    if b {
        println!("b is true");
    } else {
        println!("b is false");
    }
}
```

### 3.2.1.3 å­—ç¬¦ç±»å‹

charç±»å‹ç”¨äºå­˜æ”¾å•ä¸ªunicodeå­—ç¬¦ï¼Œå ç”¨4ä¸ªå­—èŠ‚ç©ºé—´ã€‚å½“å­˜å‚¨charç±»å‹æ•°æ®æ—¶ï¼ŒRustä¼šå°†å…¶è½¬æ¢ä¸ºutf-8ç¼–ç çš„æ•°æ®å­˜å‚¨ã€‚`char`å­—é¢é‡æ˜¯å•å¼•å·åŒ…å«çš„ä»»æ„å•ä¸ªå­—ç¬¦ï¼Œå­—ç¬¦ç±»å‹ä½¿ç”¨ç¤ºä¾‹å¦‚ä¸‹ï¼š

```rust
fn main() {
    let c: char = 'z';
    let x: char = 'x';
    let heart_eyed_cat: char = 'ğŸ˜»';
}
```

## 3.2.2. åŸç”Ÿå¤åˆç±»å‹

å¤åˆç±»å‹æ˜¯å°†å¤šä¸ªå€¼ç»„åˆæˆä¸€ä¸ªç±»å‹ã€‚Rustæœ‰ä¸¤ä¸ªåŸç”Ÿå¤åˆç±»å‹ï¼šå…ƒç»„å’Œæ•°ç»„ã€‚

### 3.2.2.1 å…ƒç»„

åœ†æ‹¬å·ä»¥åŠå…¶ä¸­é€—å·åˆ†å‰²çš„å€¼åˆ—è¡¨ç»„æˆå…ƒç»„ï¼Œå®šä¹‰ä¸€ä¸ªå…ƒç»„æ–¹å¼å¦‚ä¸‹ï¼š

```rust
fn main() {
    let tup: (i32, f64, u8) = (500, 6.4, 1);
}
```

å¯ä»¥å°†å…ƒç»„é‡æ–°ç»“æ„åˆ°å˜é‡ä¸Šï¼Œå¦‚ä¸‹ï¼š

```rust
fn main() {
    let tup = (500, 6.4, 1);
    let (x, y, z) = tup;
    //æ¥ä¸‹æ¥ä½ å¯ä»¥ä½¿ç”¨xã€yã€z
}
```

ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨å…ƒç»„çš„å…ƒç´ ï¼Œå¦‚ä¸‹ï¼š

```rust
fn main() {
    let x: (i32, f64, u8) = (500, 6.4, 1);
    let first = x.0;
    let second = x.1;
    let third = x.2;
}
```

ä¸å¸¦ä»»ä½•å€¼çš„å…ƒç»„ï¼Œç§°ä¸ºunitç±»å‹ï¼ˆå•å…ƒå…ƒç»„ï¼‰ï¼Œå¯ä»¥ä»£è¡¨ç©ºå€¼æˆ–è€…ç©ºçš„è¿”å›ç±»å‹ï¼Œå¦‚ä¸‹ï¼š

```rust
fn main() {
    let x: () = (); // å°†å€¼()ä¿å­˜åˆ°ç±»å‹ä¸º()çš„å˜é‡xä¸­
}
```

### 3.2.2.2 æ•°ç»„

æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ çš„ç±»å‹å¿…é¡»ç›¸åŒï¼Œæ•°ç»„çš„é•¿åº¦æ˜¯å›ºå®šçš„ï¼Œæ•°ç»„çš„å®šä¹‰æ–¹å¼å¦‚ä¸‹ï¼š

```rust
fn main() {
    let a = [1, 2, 3, 4, 5];           //ç›´æ¥å†™æ•°ç»„çš„å€¼
    let b: [i32; 5] = [1, 2, 3, 4, 5]; //æ˜¾ç¤ºæŒ‡å®šæ•°ç»„çš„ç±»å‹å’Œé•¿åº¦
    let c: [i32; 5] = [3; 5];          //æ•°ç»„æ¯ä¸ªå…ƒç´ ä¸ºåŒæ ·çš„å€¼ï¼Œç­‰ä»·äºlet a = [3, 3, 3, 3, 3];
}
```

æ•°ç»„é€šè¿‡ç´¢å¼•æ¥è®¿é—®å…ƒç´ ï¼Œç´¢å¼•ä»0å¼€å§‹è®¡æ•°ï¼Œå¦‚ä¸‹ï¼š

```rust
fn main() {
    let a = [1, 2, 3, 4, 5];

    let first = a[0];   // first = 1
    let second = a[1];  // second = 2
}
```

Rustä¸­ï¼Œè®¿é—®æ— æ•ˆçš„ç´¢å¼•å…ƒç´ ä¼šæŠ¥é”™ï¼Œå¦‚ä¸‹ï¼š

```rust
fn main() {
    let a = [1, 2, 3, 4, 5];
    let b = a[5]; // é”™è¯¯ï¼Œåªèƒ½æ”¾ä¸º0-4ï¼Œæ‰€ä»¥è¿™ä¸ªä»£ç å°†æ— æ³•ç¼–è¯‘
}
```

## 3.2.3 ç±»å‹è½¬æ¢ (å°‘ä¸€ä¸ªFrom, Into, TryFrom, TryInto)

Rustä¸­å¯ä»¥ä½¿ç”¨`as`è¿›è¡Œç±»å‹è½¬æ¢ã€‚

- æ•°å€¼ç±»å‹ä¹‹é—´é»˜è®¤ä¸ä¼šéšå¼è½¬æ¢ï¼Œå¦‚æœè¦è½¬æ¢ï¼Œåˆ™éœ€æ‰‹åŠ¨ä½¿ç”¨`as`è¿›è¡Œè½¬æ¢ã€‚
- boolç±»å‹å¯ä»¥è½¬æ¢ä¸ºå„ç§æ•°å€¼ç±»å‹ï¼Œ`false`å¯¹åº”`0`ï¼Œ`true`å¯¹åº”`1`ã€‚
- å¯ä»¥é€šè¿‡`as`å°†`char`ç±»å‹è½¬æ¢ä¸ºå„ç§æ•´å‹ï¼Œç›®æ ‡ç±»å‹å°äº4å­—èŠ‚æ—¶ï¼Œä¼šä»é«˜ä½æˆªæ–­ã€‚
- å¯ä»¥é€šè¿‡`as`å°†`u8`è½¬æ¢ä¸º`char`ç±»å‹ã€‚
- å¯ä»¥ä½¿ç”¨`std::char::from_u32`å°†`u32`è½¬æ¢ä¸º`char`ç±»å‹ã€‚
- å¯ä»¥ä½¿ç”¨`std::char::from_digit`å°†åè¿›åˆ¶æ•´å‹è½¬æ¢ä¸º`char`ç±»å‹ã€‚

```rust
fn main() {
    // æ•°å€¼ç±»å‹çš„è½¬æ¢
    assert_eq!(10i8 as u16, 10u16);
    assert_eq!(123u16 as i16, 123i16);
    // boolç±»å‹è½¬æ¢
    assert_eq!(false as u32, 0u32);
    assert_eq!(true as i8, 1i8);
    // charç±»å‹ç›¸å…³è½¬æ¢
    assert_eq!('æˆ‘' as i32, 25105i32);  // charè½¬æ¢åˆ°i32
    assert_eq!('æ˜¯' as u8, 47u8);       // charè½¬æ¢åˆ°u8ï¼Œä¼šè¢«æˆªæ–­
    assert_eq!(97u8 as char, 'a');      // u8è½¬æ¢åˆ°char
    assert_eq!(std::char::from_u32(0x2764).unwrap(), 'â¤');
    assert_eq!(std::char::from_digit(4, 10).unwrap(), '4');
}
```
